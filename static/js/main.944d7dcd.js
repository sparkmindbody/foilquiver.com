(self.webpackChunkweb=self.webpackChunkweb||[]).push([[792],{640:(e,t,r)=>{var n=r(2299),o=r(6665),i=r(6520),s=r(2167),a=r(5229),l=r(8833),c=r(3929),d=r(6283),u=r(3668),h=r(5648),y=r(4667),p=r(2348),m=r(397);class g extends o.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){}handleRetry=()=>{this.setState({hasError:!1,error:null})};render(){return this.state.hasError?(0,m.jsx)(x,{error:this.state.error,onRetry:this.handleRetry}):this.props.children}}const x=({error:e,onRetry:t})=>{const{colors:r}=(0,y.D)();return(0,m.jsx)(c.A,{style:[b.container,{backgroundColor:r.background.primary}],children:(0,m.jsxs)(c.A,{style:b.content,children:[(0,m.jsx)(d.A,{style:[b.title,{color:r.error}],children:"Something went wrong"}),(0,m.jsx)(d.A,{style:[b.message,{color:r.text.secondary}],children:e?.message||"An unexpected error occurred"}),(0,m.jsx)(h.A,{style:[b.button,{backgroundColor:r.primary}],onPress:t,children:(0,m.jsx)(d.A,{style:[b.buttonText,{color:r.text.inverse}],children:"Try Again"})}),!1]})})},b=u.A.create({container:{flex:1,alignItems:"center",justifyContent:"center",padding:p.Y.LARGE},content:{maxWidth:600,width:"100%",alignItems:"center"},title:{fontSize:24,fontWeight:"bold",marginBottom:p.Y.MEDIUM,textAlign:"center"},message:{fontSize:16,marginBottom:p.Y.LARGE,textAlign:"center"},button:Object.assign({paddingHorizontal:p.Y.LARGE,paddingVertical:p.Y.MEDIUM,borderRadius:8,marginBottom:p.Y.LARGE},{cursor:"pointer"}),buttonText:{fontSize:16,fontWeight:"600"},stack:{fontSize:12,fontFamily:"monospace",marginTop:p.Y.LARGE,padding:p.Y.MEDIUM,width:"100%"}});var f=r(5663),A=r(7821),j=r(6447),v=r(3295),C=r(8587),S=r(5708),w=r(558),I=r(8196),T=r(6773),E=r(2763);const M=({value:e,onChangeText:t,onClear:r,placeholder:n="Search foils...",autoFocus:o=!1,mode:i="browse",onFocus:s})=>{const{colors:a}=(0,y.D)(),{width:l}=(0,w.A)(),u=l<E.Dy;return(0,m.jsxs)(c.A,{style:[O.container,{backgroundColor:a.background.secondary}],children:[(0,m.jsx)(d.A,{style:[O.searchIcon,{color:a.text.secondary}],children:"\ud83d\udd0d"}),(0,m.jsx)(T.A,Object.assign({style:[O.input,{color:a.text.primary}],value:e,onChangeText:t,placeholder:(()=>{if(u)switch(i){case"comparison":case"quiver":return"Search to add...";default:return"Search foils..."}switch(i){case"comparison":return"Search foils to add to comparison...";case"quiver":return"Search foils to add to quiver...";default:return"Search foils..."}})(),placeholderTextColor:a.text.tertiary,autoFocus:o,onFocus:s,autoCapitalize:"none",autoCorrect:!1,clearButtonMode:"never",returnKeyType:"search",maxFontSizeMultiplier:1},{spellCheck:!1,autoComplete:"off"})),""!==e&&(0,m.jsx)(h.A,{onPress:r,style:O.clearButton,children:(0,m.jsx)(d.A,{style:[O.clearIcon,{color:a.text.secondary}],children:"\u2715"})})]})},O=u.A.create({container:{flexDirection:"row",alignItems:"center",paddingHorizontal:p.Y.MEDIUM,height:40,borderRadius:8,gap:p.Y.SMALL},input:Object.assign({flex:1,fontSize:16,height:"100%"},{outlineStyle:"none",border:"none",background:"transparent",lineHeight:40}),clearButton:Object.assign({height:"100%",aspectRatio:1,alignItems:"center",justifyContent:"center"},{cursor:"pointer"}),searchIcon:{fontSize:16,width:20,height:20,textAlign:"center",lineHeight:20},clearIcon:{fontSize:16,width:20,height:20,textAlign:"center",lineHeight:20}});var B=r(8264),D=r(4307),k=r(484),R=r(1690),q=r(9149),_=r(3600),N=r(5701),F=r(530),P=r(1385),L=r(5713);const z=()=>{const[e,t]=(0,o.useState)(!1);return{signInWithGoogle:async()=>{try{t(!0);const e=(()=>{const e=window.location.origin,t=window.location.hostname;return"localhost"===t||t.includes("127.0.0.1")?"http://localhost:19006":e})(),{data:r,error:n}=await N.N.auth.signInWithOAuth({provider:"google",options:{redirectTo:e,queryParams:{access_type:"offline",prompt:"consent"}}});return{data:r,error:n}}catch(e){return{data:null,error:e}}finally{t(!1)}},isLoading:e}};var W=r(3710);const V=({onSuccess:e})=>{const{signInWithGoogle:t,isLoading:r}=z();return(0,m.jsx)(h.A,{style:U.button,onPress:async()=>{try{const{error:r}=await t();if(r)return void R.A.alert("Sign In Error",r instanceof W.lR?r.message:"Failed to sign in");e?.()}catch(r){R.A.alert("Error","An unexpected error occurred during sign in.")}},disabled:r,children:r?(0,m.jsx)(F.A,{color:L.T.text.inverse}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(P.A,{name:"logo-google",size:24,color:L.T.text.inverse,style:U.icon}),(0,m.jsx)(d.A,{style:U.buttonText,children:"Sign in with Google"})]})})},U=u.A.create({button:{flexDirection:"row",alignItems:"center",justifyContent:"center",backgroundColor:L.T.primary,padding:12,borderRadius:8,minWidth:220},buttonText:{color:L.T.text.inverse,fontSize:16,fontWeight:"600"},icon:{marginRight:8}});function Y({filterOptions:e,selectedBrands:t,selectedSeries:r,selectedTypes:n,onFilterChange:i,onClearFilters:s,columns:a,onColumnVisibilityChange:l,onResetColumns:u,foils:h}){const[p,g]=(0,o.useState)(!1),[x,b]=(0,o.useState)("filters"),{colors:f,isDark:A,toggleTheme:v}=(0,y.D)(),[C,w]=(0,o.useState)(null),[I,T]=(0,o.useState)(null),[E,M]=(0,o.useState)(!1);(0,o.useEffect)((()=>{N.N.auth.getSession().then((({data:{session:e}})=>{w(e),T(e?.user??null)}));const{data:{subscription:e}}=N.N.auth.onAuthStateChange(((e,t)=>{w(t),T(t?.user??null)}));return()=>e.unsubscribe()}),[]),(0,o.useEffect)((()=>{(async()=>{try{const e=await(0,_.Ir)();e&&(e.brands.forEach((e=>i("brands",e))),e.series.forEach((e=>i("series",e))),e.types.forEach((e=>i("type",e))));const t=await(0,_.E7)();if(t){const e=Object.fromEntries(a.map((e=>[e.id,e.isVisible])));Object.entries(t).forEach((([t,r])=>{e[t]!==r&&l(t)}))}}catch(e){}})()}),[]),(0,o.useEffect)((()=>{(async()=>{try{const e={brands:t,series:r,types:n};await(0,_.ri)(e)}catch(e){}})()}),[t,r,n]),(0,o.useEffect)((()=>{(async()=>{try{const e={};a.forEach((t=>{e[t.id]=t.isVisible})),await(0,_.pF)(e)}catch(e){}})()}),[a]);const O=async()=>{try{const{error:e}=await N.N.auth.signOut();if(e)throw e;w(null),T(null),g(!1)}catch(e){R.A.alert("Error","Failed to sign out")}},F=(0,o.useMemo)((()=>{if(0===t.length)return e.series;const r=new Set;return h.forEach((e=>{t.includes(e.brand)&&e.series&&r.add(e.series)})),Array.from(r).sort()}),[e.series,t,h]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(S.A,{onPress:()=>g(!0),style:[Q.iconButton,{backgroundColor:f.background.secondary}],children:(0,m.jsx)(q.A,{name:"settings",size:24,color:f.text.primary})}),(0,m.jsx)(B.A,{visible:p,transparent:!0,animationType:"fade",onRequestClose:()=>g(!1),children:(0,m.jsx)(S.A,{style:[Q.modalOverlay,{backgroundColor:A?"rgba(0, 0, 0, 0.7)":"rgba(0, 0, 0, 0.5)"}],onPress:()=>g(!1),children:(0,m.jsxs)(S.A,{style:[Q.modalContent,{backgroundColor:f.background.primary}],onPress:e=>e.stopPropagation(),children:[(0,m.jsxs)(c.A,{style:[Q.modalHeader,{borderBottomColor:f.border}],children:[(0,m.jsx)(d.A,{style:[Q.modalTitle,{color:f.text.primary}],children:"Settings"}),(0,m.jsx)(S.A,{onPress:()=>g(!1),style:Q.closeButton,children:(0,m.jsx)(q.A,{name:"close",size:24,color:f.text.secondary})})]}),(0,m.jsxs)(c.A,{style:[Q.tabs,{borderBottomColor:f.border}],children:[(0,m.jsx)(S.A,{style:[Q.tab,"filters"===x&&[Q.activeTab,{borderBottomColor:f.primary}]],onPress:()=>b("filters"),children:(0,m.jsxs)(d.A,{style:[Q.tabText,{color:f.text.secondary},"filters"===x&&[Q.activeTabText,{color:f.primary}]],children:["Filters ",(t.length>0||r.length>0||n.length>0)&&"\u2022"]})}),(0,m.jsx)(S.A,{style:[Q.tab,"columns"===x&&[Q.activeTab,{borderBottomColor:f.primary}]],onPress:()=>b("columns"),children:(0,m.jsxs)(d.A,{style:[Q.tabText,{color:f.text.secondary},"columns"===x&&[Q.activeTabText,{color:f.primary}]],children:["Columns ",a.some((e=>!e.isVisible))&&"\u2022"]})}),(0,m.jsx)(S.A,{style:[Q.tab,"appearance"===x&&[Q.activeTab,{borderBottomColor:f.primary}]],onPress:()=>b("appearance"),children:(0,m.jsx)(d.A,{style:[Q.tabText,{color:f.text.secondary},"appearance"===x&&[Q.activeTabText,{color:f.primary}]],children:"Appearance"})}),(0,m.jsx)(S.A,{style:[Q.tab,"account"===x&&[Q.activeTab,{borderBottomColor:f.primary}]],onPress:()=>b("account"),children:(0,m.jsx)(d.A,{style:[Q.tabText,{color:f.text.secondary},"account"===x&&[Q.activeTabText,{color:f.primary}]],children:"Account"})})]}),"filters"===x?(0,m.jsx)(c.A,{style:Q.contentWrapper,children:(0,m.jsx)(D.A,{style:Q.scrollView,contentContainerStyle:Q.scrollContent,children:(0,m.jsxs)(c.A,{style:Q.content,children:[(0,m.jsxs)(c.A,{style:Q.headerWithAction,children:[(0,m.jsx)(d.A,{style:[Q.contentTitle,{color:f.text.primary}],children:"Active Filters"}),(t.length>0||r.length>0||n.length>0)&&(0,m.jsx)(S.A,{onPress:s,style:[Q.clearButton,{backgroundColor:f.background.secondary}],children:(0,m.jsx)(d.A,{style:[Q.clearButtonText,{color:f.text.secondary}],children:"Clear All"})})]}),(0,m.jsxs)(c.A,{style:Q.section,children:[(0,m.jsx)(d.A,{style:[Q.sectionTitle,{color:f.text.primary}],children:"Brand"}),(0,m.jsx)(c.A,{style:Q.chipContainer,children:e.brands.map((e=>(0,m.jsx)(S.A,{style:[Q.chip,{backgroundColor:f.background.secondary},t.includes(e)&&[Q.chipSelected,{backgroundColor:f.primary}]],onPress:()=>i("brands",e),children:(0,m.jsx)(d.A,{style:[Q.chipText,{color:f.text.secondary},t.includes(e)&&[Q.chipTextSelected,{color:f.text.inverse}]],children:e})},e)))})]}),(0,m.jsxs)(c.A,{style:Q.section,children:[(0,m.jsx)(d.A,{style:[Q.sectionTitle,{color:f.text.primary}],children:"Type"}),(0,m.jsx)(c.A,{style:Q.chipContainer,children:e.types.map((e=>(0,m.jsx)(S.A,{style:[Q.chip,{backgroundColor:f.background.secondary},n.includes(e)&&[Q.chipSelected,{backgroundColor:f.primary}]],onPress:()=>i("type",e),children:(0,m.jsx)(d.A,{style:[Q.chipText,{color:f.text.secondary},n.includes(e)&&[Q.chipTextSelected,{color:f.text.inverse}]],children:e})},e)))})]}),(0,m.jsxs)(c.A,{style:Q.section,children:[(0,m.jsx)(d.A,{style:[Q.sectionTitle,{color:f.text.primary}],children:"Series"}),(0,m.jsx)(c.A,{style:Q.chipContainer,children:F.length>0?F.map((e=>(0,m.jsx)(S.A,{style:[Q.chip,{backgroundColor:f.background.secondary},r.includes(e)&&[Q.chipSelected,{backgroundColor:f.primary}]],onPress:()=>i("series",e),children:(0,m.jsx)(d.A,{style:[Q.chipText,{color:f.text.secondary},r.includes(e)&&[Q.chipTextSelected,{color:f.text.inverse}]],children:e})},e))):(0,m.jsx)(d.A,{style:[Q.noSeriesText,{color:f.text.secondary}],children:"No series available for selected brands"})})]})]})})}):"columns"===x?(0,m.jsx)(c.A,{style:Q.contentWrapper,children:(0,m.jsx)(D.A,{style:Q.scrollView,contentContainerStyle:Q.scrollContent,children:(0,m.jsxs)(c.A,{style:Q.content,children:[(0,m.jsxs)(c.A,{style:Q.headerWithAction,children:[(0,m.jsx)(d.A,{style:[Q.contentTitle,{color:f.text.primary}],children:"Visible Columns"}),a.some((e=>!e.isVisible))&&(0,m.jsx)(S.A,{onPress:async()=>{u();try{const e={};a.forEach((t=>{e[t.id]=t.isVisible})),await(0,_.pF)(e)}catch(e){}},style:[Q.clearButton,{backgroundColor:f.background.secondary}],children:(0,m.jsx)(d.A,{style:[Q.clearButtonText,{color:f.text.secondary}],children:"Reset"})})]}),(0,m.jsx)(c.A,{style:Q.columnList,children:a.map((e=>(0,m.jsxs)(S.A,{style:Q.columnItem,onPress:()=>(async e=>{l(e)})(e.id),children:[(0,m.jsx)(d.A,{style:[Q.columnLabel,{color:f.text.primary}],children:e.label}),(0,m.jsx)(c.A,{style:[Q.checkbox,{borderColor:f.border},e.isVisible&&[Q.checkboxChecked,{backgroundColor:f.primary,borderColor:f.primary}]],children:e.isVisible&&(0,m.jsx)(q.A,{name:"check",size:16,color:f.text.inverse})})]},e.id)))})]})})}):"appearance"===x?(0,m.jsx)(c.A,{style:Q.contentWrapper,children:(0,m.jsx)(D.A,{style:Q.scrollView,contentContainerStyle:Q.scrollContent,children:(0,m.jsxs)(c.A,{style:Q.content,children:[(0,m.jsx)(d.A,{style:[Q.contentTitle,{color:f.text.primary}],children:"Theme Settings"}),(0,m.jsx)(c.A,{style:Q.section,children:(0,m.jsx)(S.A,{style:[Q.menuButton,{backgroundColor:f.background.secondary}],onPress:v,children:(0,m.jsxs)(c.A,{style:Q.menuButtonContent,children:[(0,m.jsx)(q.A,{name:A?"dark-mode":"light-mode",size:20,color:f.text.primary}),(0,m.jsx)(d.A,{style:[Q.menuButtonText,{color:f.text.primary}],children:A?"Dark Mode":"Light Mode"})]})})})]})})}):C?(0,m.jsx)(c.A,{style:Q.contentWrapper,children:(0,m.jsx)(D.A,{style:Q.scrollView,contentContainerStyle:Q.scrollContent,children:(0,m.jsxs)(c.A,{style:Q.content,children:[(0,m.jsxs)(c.A,{style:Q.userInfo,children:[I?.user_metadata?.avatar_url&&(0,m.jsx)(k.A,{source:{uri:I.user_metadata.avatar_url},style:Q.avatarImage}),(0,m.jsxs)(c.A,{style:Q.userTextInfo,children:[(0,m.jsx)(d.A,{style:[Q.userName,{color:f.text.primary}],children:I?.user_metadata?.full_name||I?.email}),(0,m.jsx)(d.A,{style:[Q.userEmail,{color:f.text.secondary}],children:I?.email})]})]}),(0,m.jsx)(c.A,{style:[Q.menuDivider,{backgroundColor:f.border}]}),(0,m.jsxs)(c.A,{style:Q.section,children:[(0,m.jsx)(d.A,{style:[Q.sectionTitle,{color:f.text.primary}],children:"Quivers"}),(0,m.jsxs)(S.A,{style:[Q.menuButton,{backgroundColor:f.background.secondary}],onPress:()=>{M(!0)},children:[(0,m.jsxs)(c.A,{style:Q.menuButtonContent,children:[(0,m.jsx)(d.A,{style:{fontSize:20,color:f.text.primary},children:"\ud83c\udfaf"}),(0,m.jsx)(d.A,{style:[Q.menuButtonText,{color:f.text.primary}],children:"Manage Quivers"})]}),(0,m.jsx)(q.A,{name:"chevron-right",size:20,color:f.text.secondary})]})]}),(0,m.jsx)(c.A,{style:Q.section,children:(0,m.jsx)(S.A,{style:[Q.signOutButton,{backgroundColor:f.background.secondary}],onPress:O,children:(0,m.jsxs)(c.A,{style:Q.menuButtonContent,children:[(0,m.jsx)(d.A,{style:{fontSize:20,color:f.text.primary},children:"\u21e5"}),(0,m.jsx)(d.A,{style:[Q.menuButtonText,{color:f.text.primary}],children:"Sign Out"})]})})})]})})}):(0,m.jsx)(c.A,{style:Q.contentWrapper,children:(0,m.jsxs)(c.A,{style:Q.content,children:[(0,m.jsx)(d.A,{style:[Q.contentTitle,{color:f.text.primary,marginBottom:16}],children:"Sign In"}),(0,m.jsx)(V,{onSuccess:()=>{g(!1)}})]})})]})})}),(0,m.jsx)(B.A,{visible:E,transparent:!0,animationType:"fade",onRequestClose:()=>M(!1),children:(0,m.jsx)(c.A,{style:[Q.modalOverlay,{backgroundColor:"rgba(0, 0, 0, 0.5)"}],onStartShouldSetResponder:()=>!0,children:(0,m.jsx)(c.A,{style:[Q.modalContent,{backgroundColor:f.background.primary}],children:(0,m.jsx)(j.G,{selectedFoils:[],onClose:()=>M(!1),initialTab:"saved",standalone:!0})})})})]})}const Q=u.A.create({container:{position:"relative"},button:{padding:p.Y.MEDIUM},iconButton:{padding:p.Y.XSMALL,borderRadius:8},modalContent:{width:"100%",maxWidth:600,borderRadius:12,maxHeight:"90%",overflow:"hidden"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:p.Y.LARGE,borderBottomWidth:1},buttonGroup:{flexDirection:"row",alignItems:"center",gap:p.Y.SMALL},columnGroup:{flexDirection:"column",gap:p.Y.MEDIUM},filterGroup:{padding:p.Y.MEDIUM},filterList:{gap:p.Y.MEDIUM},modalOverlay:{flex:1,justifyContent:"center",alignItems:"center",padding:p.Y.LARGE},modalTitle:{fontSize:18,fontWeight:"600"},closeButton:{padding:4},tabs:{flexDirection:"row",borderBottomWidth:1},tab:{flex:1,padding:12,alignItems:"center"},activeTab:{borderBottomWidth:2},tabText:{fontSize:14,fontWeight:"500"},activeTabText:{},content:{padding:16,width:"100%"},contentWrapper:{flex:1},scrollView:{flex:1},scrollContent:{flexGrow:1},section:{marginBottom:24},sectionTitle:{fontSize:14,fontWeight:"600",marginBottom:12},chipContainer:{flexDirection:"row",flexWrap:"wrap",gap:8},chip:{borderRadius:16,paddingHorizontal:12,paddingVertical:6},chipSelected:{},chipText:{fontSize:14},chipTextSelected:{},columnList:{gap:12},columnItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:8},columnLabel:{fontSize:14},checkbox:{width:20,height:20,borderRadius:4,borderWidth:2,alignItems:"center",justifyContent:"center"},checkboxChecked:{},headerWithAction:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},contentTitle:{fontSize:16,fontWeight:"600"},clearButton:{paddingHorizontal:12,paddingVertical:6,borderRadius:16},clearButtonText:{fontSize:14},noSeriesText:{fontSize:14,fontWeight:"500"},userInfo:{flexDirection:"row",alignItems:"center",gap:12,marginBottom:16},userTextInfo:{flex:1},avatarImage:{width:48,height:48,borderRadius:24},userName:{fontSize:16,fontWeight:"600",marginBottom:4},userEmail:{fontSize:14},menuDivider:{height:1,marginBottom:16},menuButton:Object.assign({flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:12,borderRadius:8},{cursor:"pointer"}),menuButtonContent:{flexDirection:"row",alignItems:"center",gap:12},menuButtonText:{fontSize:14,fontWeight:"500"},signOutButton:Object.assign({flexDirection:"row",alignItems:"center",padding:12,borderRadius:8},{cursor:"pointer"})});var G=r(209),J=r(2419),H=r(9659),X=r(382);const Z=["children"],$=o.lazy((()=>r.e(269).then(r.bind(r,3269)))),K=o.lazy((()=>r.e(415).then(r.bind(r,6415)))),ee=o.lazy((()=>r.e(358).then(r.bind(r,7358)))),te=o.lazy((()=>r.e(951).then(r.bind(r,8951)))),re=o.lazy((()=>r.e(50).then(r.bind(r,3050)))),ne=o.lazy((()=>r.e(553).then(r.bind(r,4553)))),oe=(0,I.A)();function ie({name:e,color:t}){{const r={home:"\ud83c\udfe0",browse:"\ud83d\udd0d",compare:"\u2696\ufe0f",settings:"\u2699\ufe0f",quiver:"\ud83d\udd16"};return(0,m.jsx)(d.A,{style:{fontSize:20,color:t},children:r[e]})}}(0,v.Qq)().webUrl,H.JZ.browse,H.JZ.comparison,H.JZ.quiver,H.JZ.terms,H.JZ.privacy,H.JZ.contact;const se=e=>{let{children:t}=e,r=(0,C.A)(e,Z);return(0,m.jsx)(o.Suspense,{fallback:(0,m.jsx)(A.I,{}),children:o.cloneElement(t,r)})},ae=()=>{const e=(0,s.cq)(),{colors:t}=(0,y.D)(),{width:r}=(0,w.A)(),n=r<E.Dy,{foils:i}=(0,G.J)(),{searchQuery:a,setSearchQuery:l,filters:u,setFilters:p,columns:g,setColumns:x,setCurrentScreen:b}=(0,f.n)(),{filterOptions:A}=(0,J.c)(i,u),{showQuiverManager:j}=(0,o.useContext)(ce),v=o.useMemo((()=>i?.length?[...new Set(i.map((e=>e.brand)))].sort():[]),[i]),C=()=>{e.navigate("Browse",{})},I=t=>{l(t),e.setParams({searchQuery:t})},T=e=>"Comparison"===e.name?"comparison":"Quiver"===e.name?"quiver":"browse",O=e=>{switch(e.name){case"Comparison":return"Search foils to add to comparison...";case"Quiver":return"Search foils to add to quiver...";default:return"Search foils..."}},B=t=>{"Browse"===t.name&&e.setParams({showSearchDropdown:!0})},D=(e,t)=>{((e,t)=>{p((r=>Object.assign({},r,{[e]:r[e].includes(t)?r[e].filter((e=>e!==t)):[...r[e],t]})))})(e,t)},k=()=>{p({brands:[],series:[],type:[]})},R=e=>{x((t=>t.map((t=>t.id===e?Object.assign({},t,{isVisible:!t.isVisible}):t))))},q=()=>{x(E._X)},N=o.useMemo((()=>(0,E.lD)(g)),[g]);o.useMemo((()=>(0,E.y6)(N,r,n)),[N,r,n]),o.useMemo((()=>n?"100%":Math.min(N+2*E.Op,r)),[N,r,n]);(0,o.useEffect)((()=>{(async()=>{try{const e=await(0,_.E7)();if(e){const t=E._X.map((t=>Object.assign({},t,{isVisible:"boolean"===typeof e[t.id]?e[t.id]:t.isVisible})));x(t)}}catch(e){}})()}),[]),(0,o.useEffect)((()=>{(async()=>{try{const e=await(0,_.Ir)();e&&p({brands:e.brands||[],series:e.series||[],type:e.types||[]})}catch(e){}})()}),[]);const F=o.useMemo((()=>{if(n)return{width:"100%",paddingHorizontal:E.Op};const e=(0,E.lD)(g);return{width:e,maxWidth:(0,E.y6)(e,r,!1),alignSelf:"center"}}),[g,r,n]),P=e=>n?(0,m.jsxs)(c.A,{style:le.headerRightContainerMobile,children:[(0,m.jsx)(h.A,{style:[le.headerButton],onPress:j,children:(0,m.jsx)(ie,{name:"quiver",color:t.text.primary})}),(0,m.jsx)(Y,{filterOptions:A,selectedBrands:u.brands,selectedSeries:u.series,selectedTypes:u.type,onFilterChange:D,onClearFilters:k,columns:g,onColumnVisibilityChange:R,onResetColumns:q,foils:i})]}):(0,m.jsxs)(c.A,{style:le.headerRightContainerWeb,children:[(0,m.jsxs)(h.A,{style:[le.headerButton],onPress:j,children:[(0,m.jsx)(ie,{name:"quiver",color:t.text.primary}),!n&&(0,m.jsx)(d.A,{style:[le.headerButtonText,{color:t.text.primary}],children:"My Quivers"})]}),(0,m.jsx)(Y,{filterOptions:A,selectedBrands:u.brands,selectedSeries:u.series,selectedTypes:u.type,onFilterChange:D,onClearFilters:k,columns:g,onColumnVisibilityChange:R,onResetColumns:q,foils:i})]});return(0,m.jsxs)(oe.Navigator,{screenOptions:{headerStyle:{backgroundColor:t.background.primary},headerShadowVisible:!1},children:[(0,m.jsx)(oe.Screen,{name:"Browse",options:({route:e})=>({headerTitle:e.params?.title||"",headerLeft:()=>(0,m.jsx)(c.A,{style:[le.headerOuterContainer,{backgroundColor:t.background.primary},!n&&{alignItems:"center"}],children:n?(0,m.jsx)(c.A,{style:le.headerMainContainerMobile,children:(0,m.jsxs)(c.A,{style:le.headerTopRowMobile,children:[(0,m.jsx)(S.A,{onPress:C,style:({pressed:e})=>[le.logoContainerMobile,e&&le.logoPressed],children:(0,m.jsx)(d.A,{style:[le.headerTitleMobile,{color:t.primary}],children:"Foilquiver"})}),(0,m.jsx)(c.A,{style:le.searchBarContainerMobile,children:(0,m.jsx)(M,{value:a,onChangeText:e=>I(e),onClear:()=>I(""),mode:T(e),placeholder:O(e),onFocus:()=>B(e)})}),P()]})}):(0,m.jsx)(c.A,{style:[le.headerMainContainerWeb,F],children:(0,m.jsxs)(c.A,{style:[le.headerContentWeb,{width:"100%",alignItems:"center",justifyContent:"space-between"}],children:[(0,m.jsx)(S.A,{onPress:C,style:({pressed:e})=>[le.logoContainer,e&&le.logoPressed],children:(0,m.jsx)(d.A,{style:[le.headerTitle,{color:t.primary}],children:"Foilquiver"})}),(0,m.jsx)(c.A,{style:[le.searchBarContainerWeb,{flex:1}],children:(0,m.jsx)(M,{value:a,onChangeText:e=>I(e),onClear:()=>I(""),mode:T(e),placeholder:O(e),onFocus:()=>B(e)})}),P()]})})})}),children:e=>(0,m.jsx)(se,{children:(0,m.jsx)($,Object.assign({},e,{filters:u,onFilterChange:D,columns:g,brands:v}))})}),(0,m.jsx)(oe.Screen,{name:"Comparison",options:({route:e})=>({headerTitle:e.params?.title||"",headerLeft:()=>(0,m.jsx)(c.A,{style:[le.headerOuterContainer,{backgroundColor:t.background.primary},!n&&{alignItems:"center"}],children:n?(0,m.jsx)(c.A,{style:le.headerMainContainerMobile,children:(0,m.jsxs)(c.A,{style:le.headerTopRowMobile,children:[(0,m.jsx)(S.A,{onPress:C,style:({pressed:e})=>[le.logoContainerMobile,e&&le.logoPressed],children:(0,m.jsx)(d.A,{style:[le.headerTitleMobile,{color:t.primary}],children:"Foilquiver"})}),(0,m.jsx)(c.A,{style:le.searchBarContainerMobile,children:(0,m.jsx)(M,{value:a,onChangeText:e=>I(e),onClear:()=>I(""),mode:T(e),placeholder:O(e),onFocus:()=>B(e)})}),P()]})}):(0,m.jsx)(c.A,{style:[le.headerMainContainerWeb,F],children:(0,m.jsxs)(c.A,{style:[le.headerContentWeb,{width:"100%",alignItems:"center",justifyContent:"space-between"}],children:[(0,m.jsx)(S.A,{onPress:C,style:({pressed:e})=>[le.logoContainer,e&&le.logoPressed],children:(0,m.jsx)(d.A,{style:[le.headerTitle,{color:t.primary}],children:"Foilquiver"})}),(0,m.jsx)(c.A,{style:[le.searchBarContainerWeb,{flex:1}],children:(0,m.jsx)(M,{value:a,onChangeText:e=>I(e),onClear:()=>I(""),mode:T(e),placeholder:O(e),onFocus:()=>B(e)})}),P()]})})})}),children:e=>(0,m.jsx)(se,{children:(0,m.jsx)(K,Object.assign({},e))})}),(0,m.jsx)(oe.Screen,{name:"Quiver",options:({route:e})=>({headerTitle:"",headerLeft:()=>(0,m.jsx)(c.A,{style:[le.headerOuterContainer,{backgroundColor:t.background.primary},!n&&{alignItems:"center"}],children:n?(0,m.jsx)(c.A,{style:le.headerMainContainerMobile,children:(0,m.jsxs)(c.A,{style:le.headerTopRowMobile,children:[(0,m.jsx)(S.A,{onPress:C,style:({pressed:e})=>[le.logoContainerMobile,e&&le.logoPressed],children:(0,m.jsx)(d.A,{style:[le.headerTitleMobile,{color:t.primary}],children:"Foilquiver"})}),(0,m.jsx)(c.A,{style:le.searchBarContainerMobile,children:(0,m.jsx)(M,{value:a,onChangeText:e=>I(e),onClear:()=>I(""),mode:T(e),placeholder:O(e),onFocus:()=>B(e)})}),P()]})}):(0,m.jsx)(c.A,{style:[le.headerMainContainerWeb,F],children:(0,m.jsxs)(c.A,{style:[le.headerContentWeb,{width:"100%",alignItems:"center",justifyContent:"space-between"}],children:[(0,m.jsx)(S.A,{onPress:C,style:({pressed:e})=>[le.logoContainer,e&&le.logoPressed],children:(0,m.jsx)(d.A,{style:[le.headerTitle,{color:t.primary}],children:"Foilquiver"})}),(0,m.jsx)(c.A,{style:[le.searchBarContainerWeb,{flex:1}],children:(0,m.jsx)(M,{value:a,onChangeText:e=>I(e),onClear:()=>I(""),mode:T(e),placeholder:O(e),onFocus:()=>B(e)})}),P()]})})})}),children:e=>{const t=o.useMemo((()=>e.route.params?.foil_ids&&Array.isArray(i)?i.filter((t=>{if(!t)return!1;const r=(0,X.h)(t);return e.route.params.foil_ids.includes(r)})):[]),[e.route.params?.foil_ids,i]);return(0,m.jsx)(se,{children:(0,m.jsx)(ee,Object.assign({},e,{searchProps:{value:a,onChangeText:I,onClear:()=>l(""),mode:"quiver",placeholder:"Search foils in quiver..."},tableSettingsProps:{filterOptions:A,selectedBrands:u.brands,selectedSeries:u.series,selectedTypes:u.type,onFilterChange:D,onClearFilters:k,columns:g,onColumnVisibilityChange:R,onResetColumns:q,foils:t}}))})}}),(0,m.jsx)(oe.Screen,{name:"Terms",options:{headerShown:!1},children:e=>(0,m.jsx)(se,{children:(0,m.jsx)(re,Object.assign({},e))})}),(0,m.jsx)(oe.Screen,{name:"Privacy",options:{headerShown:!1},children:e=>(0,m.jsx)(se,{children:(0,m.jsx)(te,Object.assign({},e))})}),(0,m.jsx)(oe.Screen,{name:"Contact",options:{headerShown:!1},children:e=>(0,m.jsx)(se,{children:(0,m.jsx)(ne,Object.assign({},e))})})]})},le=u.A.create({headerOuterContainer:{flex:1,paddingHorizontal:E.Op},headerMainContainerMobile:{width:"100%"},headerTopRowMobile:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",height:48,width:"100%",gap:8},logoContainerMobile:{height:"100%",justifyContent:"center",minWidth:80},headerTitleMobile:{fontSize:18,fontWeight:"bold"},searchBarContainerMobile:{flex:1,height:36,minWidth:120,maxWidth:200},headerRightContainerMobile:{flexDirection:"row",alignItems:"center",gap:4,zIndex:2e3},headerMainContainerWeb:{height:72,width:"100%"},headerContentWeb:{flexDirection:"row",alignItems:"center",gap:24,height:"100%",width:"100%"},searchBarContainerWeb:{flex:1,height:40},logoContainer:{height:"100%",justifyContent:"center",minWidth:120},logoPressed:{opacity:.7},headerTitle:{fontSize:24,fontWeight:"bold"},headerRightContainerWeb:{flexDirection:"row",alignItems:"center",gap:16,paddingRight:E.Op,zIndex:2e3},headerButton:Object.assign({flexDirection:"row",alignItems:"center",gap:8,padding:6,borderRadius:8},{cursor:"pointer",userSelect:"none"}),headerButtonText:{fontSize:14,fontWeight:"500"}}),ce=o.createContext({showQuiverManager:()=>{},hideQuiverManager:()=>{}});(0,n.A)((function(){const e=(0,s.bE)(),[t,r]=(0,o.useState)(!1),n=()=>r(!1),d={prefixes:(0,v.vA)(),config:{screens:{Browse:{path:"/",parse:{mode:e=>e},stringify:{mode:e=>e}},Comparison:{path:"/comparison",exact:!0,stringify:{quiverName:e=>e,foils:e=>JSON.stringify(e)}},Quiver:{path:"/quiver/:quiverId",parse:{quiverId:e=>e,quiverName:e=>e,foils:e=>e?JSON.parse(e):void 0},stringify:{quiverId:e=>e,quiverName:e=>e,foils:e=>JSON.stringify(e)}},Terms:"/terms",Privacy:"/privacy",Contact:"/contact"}},getStateFromPath:(e,t)=>"/comparison"===e?{routes:[{name:"Comparison",params:{}}]}:(0,s.Bd)(e,t),getPathFromState:(e,t)=>{if("Comparison"===e.routes[e.routes.length-1].name)return"/comparison";return(0,s.Fy)(e,t)||"/"}};return(0,m.jsx)(y.N,{children:(0,m.jsx)(f.D,{children:(0,m.jsx)(ce.Provider,{value:{showQuiverManager:()=>r(!0),hideQuiverManager:n},children:(0,m.jsx)(a.vd,{children:(0,m.jsx)(g,{children:(0,m.jsx)(l.Oy,{children:(0,m.jsx)(i.A,{ref:e,linking:d,fallback:(0,m.jsx)(A.I,{}),children:(0,m.jsxs)(c.A,{style:{flex:1},children:[(0,m.jsx)(ae,{}),t&&(0,m.jsx)(j.G,{standalone:!1,isModalVisible:t,onClose:n,initialTab:"saved"})]})})})})})})})})}))},7821:(e,t,r)=>{r.d(t,{I:()=>d});r(6665);var n=r(3929),o=r(6283),i=r(530),s=r(3668),a=r(4667),l=r(2348),c=r(397);const d=({message:e="Loading...",size:t="large",fullScreen:r=!0})=>{const{colors:s}=(0,a.D)();return(0,c.jsxs)(n.A,{style:[u.container,r&&u.fullScreen,{backgroundColor:s.background.primary}],children:[(0,c.jsx)(i.A,{size:t,color:s.primary}),e&&(0,c.jsx)(o.A,{style:[u.message,{color:s.text.secondary}],children:e})]})},u=s.A.create({container:{padding:l.Y.LARGE,alignItems:"center",justifyContent:"center"},fullScreen:{flex:1},message:{marginTop:l.Y.MEDIUM,fontSize:16,textAlign:"center"}})},6447:(e,t,r)=>{r.d(t,{G:()=>v});var n=r(6665),o=r(3929),i=r(6283),s=r(3668),a=r(5648),l=r(8264),c=r(6773),d=r(4307),u=r(1690),h=r(558),y=r(2167),p=r(4812),m=r(4667),g=r(2763),x=r(2348),b=r(5025),f=r(5663),A=r(382),j=r(397);const v=({selectedFoils:e=[],onClose:t,initialTab:r="save",standalone:s=!1,isModalVisible:x,hideStandaloneButton:v=!1,onQuiverSaved:S})=>{const{colors:w}=(0,m.D)(),{width:I}=(0,h.A)(),T=I<g.Dy,E=(0,y.cq)(),{setSelectedFoils:M}=(0,f.n)(),[O,B]=(0,n.useState)(!s),D=void 0!==x?x:O,[k,R]=(0,n.useState)(""),[q,_]=(0,n.useState)(""),[N,F]=(0,n.useState)(r),[P,L]=(0,n.useState)(null),[z,W]=(0,n.useState)(""),{quivers:V,isLoading:U,error:Y,createQuiver:Q,deleteQuiver:G,reloadQuivers:J,updateQuiver:H}=(0,p.X)(),X=async()=>{if(P&&z.trim())try{await H(P,{name:z.trim()})&&((0,b.k4)(b.R2.UPDATE_QUIVER,{quiverId:P,action:"rename"}),window.alert("Quiver renamed successfully"),L(null),W(""),J())}catch(Y){u.A.alert("Error","Failed to rename quiver")}},Z=e=>e.foil_ids&&Array.isArray(e.foil_ids)?e.foil_ids.length:0,$=(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(o.A,{style:[C.modalHeader,{borderBottomColor:w.border}],children:[(0,j.jsx)(i.A,{style:[C.modalTitle,{color:w.text.primary}],children:"Manage Quivers"}),t&&(0,j.jsx)(a.A,{onPress:t,children:(0,j.jsx)(i.A,{style:{fontSize:24,color:w.text.primary},children:"\xd7"})})]}),e.length>0&&(0,j.jsxs)(o.A,{style:[C.tabContainer,{borderBottomColor:w.border}],children:[(0,j.jsx)(a.A,{style:[C.tab,"save"===N&&[C.activeTab,{borderBottomColor:w.primary}]],onPress:()=>F("save"),children:(0,j.jsx)(i.A,{style:[C.tabText,{color:"save"===N?w.primary:w.text.secondary}],children:"Save Quiver"})}),(0,j.jsx)(a.A,{style:[C.tab,"saved"===N&&[C.activeTab,{borderBottomColor:w.primary}]],onPress:()=>F("saved"),children:(0,j.jsx)(i.A,{style:[C.tabText,{color:"saved"===N?w.primary:w.text.secondary}],children:"Saved Quivers"})})]}),(0,j.jsx)(d.A,{style:C.modalBody,children:"save"===N?(0,j.jsxs)(o.A,{style:C.form,children:[(0,j.jsxs)(o.A,{style:C.formField,children:[(0,j.jsx)(i.A,{style:[C.label,{color:w.text.secondary}],children:"Name"}),(0,j.jsx)(c.A,{style:[C.input,{color:w.text.primary,borderColor:w.border,backgroundColor:w.background.secondary}],value:k,onChangeText:R,placeholder:"Enter quiver name",placeholderTextColor:w.text.tertiary})]}),(0,j.jsxs)(o.A,{style:C.formField,children:[(0,j.jsx)(i.A,{style:[C.label,{color:w.text.secondary}],children:"Description (optional)"}),(0,j.jsx)(c.A,{style:[C.input,C.textArea,{color:w.text.primary,borderColor:w.border,backgroundColor:w.background.secondary}],value:q,onChangeText:_,placeholder:"Enter description",placeholderTextColor:w.text.tertiary,multiline:!0,numberOfLines:3})]}),(0,j.jsx)(a.A,{style:[C.createButton,{backgroundColor:w.primary}],onPress:async()=>{if(k.trim())try{const r=await Q({name:k.trim(),description:q.trim(),foils:e});if(!r)throw new Error("Failed to create quiver - no result returned");(0,b.k4)(b.R2.SAVE_QUIVER,{foilCount:e.length,isNewQuiver:!0,fromComparison:e.length>0}),R(""),_(""),B(!1),t?.(),S?.(r.id,r.name),E.navigate("Quiver",{quiverId:r.id,quiverName:r.name,foil_ids:e.map((e=>(0,A.h)(e)))})}catch(Y){window.alert(`Failed to save quiver: ${Y instanceof Error?Y.message:"Unknown error"}`)}else window.alert("Please enter a name for your quiver")},children:(0,j.jsx)(i.A,{style:[C.buttonText,{color:w.text.inverse}],children:e.length>0?"Save Quiver":"Create Empty Quiver"})})]}):(0,j.jsx)(o.A,{style:C.quiverList,children:U?(0,j.jsx)(o.A,{style:C.centerContent,children:(0,j.jsx)(i.A,{style:[C.message,{color:w.text.secondary}],children:"Loading quivers..."})}):Y?(0,j.jsx)(o.A,{style:C.centerContent,children:(0,j.jsx)(i.A,{style:[C.message,{color:w.error}],children:Y})}):(0,j.jsxs)(o.A,{children:[0===V.length?(0,j.jsx)(o.A,{style:C.centerContent,children:(0,j.jsx)(i.A,{style:[C.message,{color:w.text.secondary}],children:"No saved quivers yet"})}):V.map((e=>(0,j.jsxs)(o.A,{style:[C.quiverItem,{borderBottomColor:w.border}],children:[(0,j.jsx)(a.A,{style:C.quiverInfo,onPress:()=>(e=>{B(!1),t?.(),M([]),E.navigate("Quiver",{quiverId:e.id,quiverName:e.name,foil_ids:e.foil_ids||[]})})(e),children:P===e.id?(0,j.jsxs)(o.A,{style:C.renameContainer,children:[(0,j.jsx)(c.A,{style:[C.renameInput,{color:w.text.primary,borderColor:w.border,backgroundColor:w.background.secondary}],value:z,onChangeText:W,placeholder:"Enter new name",placeholderTextColor:w.text.tertiary,autoFocus:!0}),(0,j.jsx)(a.A,{style:[C.renameButton,{backgroundColor:w.error}],onPress:()=>{L(null),W("")},children:(0,j.jsx)(i.A,{style:[C.renameButtonText,{color:w.text.inverse}],children:"Cancel"})}),(0,j.jsx)(a.A,{style:[C.renameButton,{backgroundColor:w.primary}],onPress:X,children:(0,j.jsx)(i.A,{style:[C.renameButtonText,{color:w.text.inverse}],children:"Save"})})]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(o.A,{style:C.quiverNameContainer,children:[(0,j.jsx)(i.A,{style:[C.quiverName,{color:w.text.primary}],children:e.name}),(0,j.jsx)(a.A,{onPress:()=>(e=>{L(e.id),W(e.name)})(e),style:C.renameIcon,children:(0,j.jsx)(i.A,{style:{color:w.text.secondary},children:"\u270e"})})]}),e.description&&(0,j.jsx)(i.A,{style:[C.quiverDescription,{color:w.text.secondary}],children:e.description}),(0,j.jsxs)(i.A,{style:[C.quiverMeta,{color:w.text.tertiary}],children:[Z(e)," foils \u2022 ",new Date(e.updated_at).toLocaleDateString()]})]})}),(0,j.jsx)("button",{type:"button",onClick:()=>{try{window.confirm("Are you sure you want to delete this quiver? This action cannot be undone.")&&G(e.id).then((e=>{e?J():window.alert("Failed to delete quiver")})).catch((e=>{window.alert("Error deleting quiver")}))}catch(Y){window.alert("Error in delete operation")}},style:{padding:"8px",borderWidth:"1px",borderStyle:"solid",borderColor:w.error,borderRadius:"8px",minWidth:"70px",backgroundColor:w.background.primary,cursor:"pointer",color:w.error,fontWeight:"600",fontSize:"14px",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10,position:"relative",pointerEvents:"auto"},children:"Delete"})]},e.id))),(0,j.jsx)(o.A,{style:C.createButtonContainer,children:(0,j.jsx)(a.A,{style:[C.createEmptyButton,{backgroundColor:w.primary}],onPress:()=>F("save"),children:(0,j.jsx)(i.A,{style:[C.buttonText,{color:w.text.inverse}],children:"Create New Quiver"})})})]})})})]});return s?$:(0,j.jsxs)(j.Fragment,{children:[e.length>0&&!s&&!x&&!v&&(0,j.jsxs)(a.A,{style:[C.saveButton,{backgroundColor:w.primary}],onPress:()=>B(!0),children:[(0,j.jsx)(i.A,{style:{fontSize:20,color:w.text.inverse,marginRight:8},children:"+"}),(0,j.jsx)(i.A,{style:[C.buttonText,{color:w.text.inverse}],children:"Save Quiver"})]}),(0,j.jsx)(l.A,{visible:D,transparent:!0,animationType:"fade",onRequestClose:()=>{B(!1),t?.()},children:(0,j.jsx)(a.A,{style:[C.modalOverlay,s&&C.standaloneOverlay],activeOpacity:1,onPress:()=>{B(!1),t?.()},children:(0,j.jsx)(a.A,{style:[C.modalContent,{backgroundColor:w.background.primary},T&&C.modalContentMobile],activeOpacity:1,onPress:e=>{e.preventDefault(),e.stopPropagation()},children:$})})})]})},C=s.A.create({saveButton:Object.assign({flexDirection:"row",alignItems:"center",justifyContent:"center",paddingHorizontal:x.Y.LARGE,paddingVertical:x.Y.MEDIUM,borderRadius:8,gap:8,minHeight:40,minWidth:120},{cursor:"pointer",pointerEvents:"auto",userSelect:"none",boxShadow:"0px 2px 4px rgba(0,0,0,0.1)"}),buttonText:Object.assign({fontSize:14,fontWeight:"600",textAlign:"center"},{userSelect:"none"}),modalOverlay:Object.assign({position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",padding:g.Op,zIndex:2e3},{position:"absolute",pointerEvents:"auto"}),modalContent:Object.assign({width:"100%",maxWidth:600,borderRadius:12,maxHeight:"90%",zIndex:2001},{pointerEvents:"auto",userSelect:"none"}),modalContentMobile:{maxWidth:"100%"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:x.Y.LARGE,borderBottomWidth:1},modalTitle:{fontSize:20,fontWeight:"600"},modalBody:{flex:1},tabContainer:{flexDirection:"row",borderBottomWidth:1},tab:{flex:1,paddingVertical:x.Y.MEDIUM,alignItems:"center"},activeTab:{borderBottomWidth:2},tabText:{fontSize:16,fontWeight:"500"},form:{padding:x.Y.LARGE},formField:{marginBottom:x.Y.LARGE},label:{fontSize:14,marginBottom:x.Y.SMALL},input:Object.assign({height:40,borderWidth:1,borderRadius:8,paddingHorizontal:x.Y.MEDIUM,fontSize:16},{outlineStyle:"none"}),textArea:{height:80,paddingTop:x.Y.MEDIUM,textAlignVertical:"top"},createButton:{paddingVertical:x.Y.MEDIUM,borderRadius:8,alignItems:"center"},quiverList:{padding:x.Y.LARGE},quiverItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:x.Y.MEDIUM,borderBottomWidth:1},quiverInfo:Object.assign({flex:1,marginRight:x.Y.MEDIUM},{cursor:"pointer"}),quiverName:{fontSize:16,fontWeight:"600",marginBottom:4},quiverDescription:{fontSize:14,marginBottom:4},quiverMeta:{fontSize:12},deleteButton:Object.assign({padding:x.Y.SMALL,borderWidth:1,borderRadius:8,minWidth:70,alignItems:"center",justifyContent:"center",zIndex:10},{cursor:"pointer",pointerEvents:"auto",userSelect:"none",position:"relative"}),deleteIcon:{fontSize:14,fontWeight:"600"},centerContent:{padding:x.Y.LARGE,alignItems:"center"},message:{fontSize:16},standaloneOverlay:{position:"relative",backgroundColor:"transparent"},renameContainer:{flexDirection:"row",alignItems:"center",gap:x.Y.SMALL},renameInput:{flex:1,height:32,borderWidth:1,borderRadius:4,paddingHorizontal:x.Y.SMALL,fontSize:14},renameButton:{paddingHorizontal:x.Y.MEDIUM,paddingVertical:x.Y.SMALL,borderRadius:4},renameButtonText:{fontSize:12,fontWeight:"500"},quiverNameContainer:{flexDirection:"row",alignItems:"center",gap:x.Y.SMALL},renameIcon:Object.assign({padding:x.Y.SMALL},{cursor:"pointer"}),createButtonContainer:{borderTopWidth:1,marginTop:x.Y.LARGE,paddingTop:x.Y.LARGE,paddingBottom:x.Y.MEDIUM},createEmptyButton:Object.assign({paddingHorizontal:x.Y.LARGE,paddingVertical:x.Y.MEDIUM,borderRadius:8,alignItems:"center",minWidth:180,alignSelf:"center"},{cursor:"pointer",userSelect:"none",boxShadow:"0px 2px 4px rgba(0,0,0,0.1)"})})},3295:(e,t,r)=>{r.d(t,{Qq:()=>i,vA:()=>s});const n={NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"FoilQuiver",slug:"FoilQuiver",version:"1.0.0",orientation:"portrait",icon:"./assets/icon.png",userInterfaceStyle:"light",splash:{image:"./assets/splash-icon.png",resizeMode:"contain",backgroundColor:"#ffffff"},web:{},extra:{production:{baseUrl:"https://foilquiver.com"},staging:{baseUrl:"https://staging.foilquiver.com"}},sdkVersion:"52.0.0",platforms:["ios","android","web"]},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.EXPO_PUBLIC_ENV||"development",o={development:{apiUrl:"http://localhost:3000",webUrl:"http://localhost:19006",appScheme:"foilquiver-dev"},staging:{apiUrl:"https://api.staging.foilquiver.com",webUrl:"https://staging.foilquiver.com",appScheme:"foilquiver-staging"},production:{apiUrl:"https://api.foilquiver.com",webUrl:"https://foilquiver.com",appScheme:"foilquiver"}},i=()=>o[n],s=()=>{const e=i();return[e.webUrl]}},2763:(e,t,r)=>{r.d(t,{Dy:()=>o,Op:()=>n,_X:()=>s,lD:()=>a,lU:()=>i,y6:()=>l});const n=16,o=768,i={brand:100,series:120,model:150,area:80,wingspan:80,aspectRatio:80,type:80,price:105,link:80},s=[{id:"brand",label:"Brand",isVisible:!0},{id:"series",label:"Series",isVisible:!1},{id:"model",label:"Model",isVisible:!0},{id:"area",label:"Area",isVisible:!0},{id:"wingspan",label:"Span",isVisible:!0},{id:"aspectRatio",label:"AR",isVisible:!0},{id:"type",label:"Type",isVisible:!0},{id:"price",label:"Price",isVisible:!0},{id:"link",label:"Link",isVisible:!0}],a=e=>e.reduce(((e,t)=>t.isVisible?e+(i[t.id]||100):e),0),l=(e,t,r)=>r?t:Math.min(e,t-48)},5663:(e,t,r)=>{r.d(t,{D:()=>l,n:()=>c});var n=r(6665),o=r(3600),i=r(2763),s=r(397);const a=(0,n.createContext)(void 0),l=({children:e})=>{const[t,r]=(0,n.useState)(""),[l,c]=(0,n.useState)({brands:[],series:[],type:[]}),[d,u]=(0,n.useState)(i._X),[h,y]=(0,n.useState)([]),[p,m]=(0,n.useState)(null);(0,n.useEffect)((()=>{(async()=>{try{const e=await(0,o.Ir)();e&&c({brands:e.brands||[],series:e.series||[],type:e.types||[]});const t=await(0,o.E7)();t&&Array.isArray(t)&&u(t.map((e=>Object.assign({},i._X.find((t=>t.id===e.id)),e))))}catch(e){}})()}),[]),(0,n.useEffect)((()=>{(0,o.ri)({brands:l.brands,series:l.series,types:l.type})}),[l]),(0,n.useEffect)((()=>{p&&c({brands:[],series:[],type:[]})}),[p]);const g={searchQuery:t,setSearchQuery:r,filters:l,setFilters:c,columns:d,setColumns:u,selectedFoils:h,setSelectedFoils:y,currentScreen:p,setCurrentScreen:m};return(0,s.jsx)(a.Provider,{value:g,children:e})},c=()=>{const e=(0,n.useContext)(a);if(void 0===e)throw new Error("useApp must be used within an AppProvider");return e}},2419:(e,t,r)=>{r.d(t,{c:()=>o});var n=r(6665);function o(e,t){const r=(0,n.useMemo)((()=>{const r=Array.from(new Set(e.map((e=>e.brand)))).sort(),n=function(e){return e.reduce(((e,t)=>(e[t.brand]||(e[t.brand]=[]),e[t.brand].push(t),e)),{})}(e);let o=[];if(0===t.brands.length)o=Array.from(new Set(e.map((e=>e.series)))).sort();else{const e=t.brands.flatMap((e=>n[e]||[]));o=Array.from(new Set(e.map((e=>e.series)))).sort()}return{brands:r,series:o,types:["front","tail"]}}),[e,t.brands]);return{filteredFoils:(0,n.useMemo)((()=>e.filter((e=>{const r=0===t.brands.length||t.brands.includes(e.brand),n=0===t.series.length||t.series.includes(e.series),o=0===t.type.length||t.type.includes(e.type);return r&&n&&o}))),[e,t.brands,t.series,t.type]),filterOptions:r}}},209:(e,t,r)=>{r.d(t,{J:()=>s});var n=r(6665),o=r(1087);class i{static isWeb=!0;static DATA_PATH="/data/foils.json";static CACHE_DIR=".cache";static getBaseUrl(){return"https://foilquiver.com"}static async getAllProducts(){try{if(this.isWeb){const t=this.getBaseUrl();try{const e=await fetch(`${t}${this.DATA_PATH}`);if(e.ok){return await e.json()}}catch(e){}try{const r=["armstrong","lift-foils","axis-foils","code-foils","kt-foils","uni-foil"],n=[];for(const o of r)try{const e=await fetch(`${t}/${this.CACHE_DIR}/${o}.json`);if(e.ok){const t=await e.json();n.push(...t)}}catch(e){}if(n.length>0)return n}catch(e){}}else{const e=await o.A.getItem("foils");if(e){return JSON.parse(e)}}}catch(e){}return[]}}function s(){const[e,t]=(0,n.useState)([]),[r,o]=(0,n.useState)(!0),[s,a]=(0,n.useState)(null),l=async()=>{try{o(!0),a(null);const e=await i.getAllProducts();t(e)}catch(e){a(e instanceof Error?e.message:"Failed to load foils")}finally{o(!1)}};(0,n.useEffect)((()=>{l()}),[]);return{foils:e,loading:r,error:s,refreshFoils:()=>{l()}}}},4812:(e,t,r)=>{r.d(t,{X:()=>y});var n=r(6665),o=(r(1087),r(5701)),i=r(382),s=r(5501);const a="@foilquiver/quivers",l=()=>window.location.hostname.includes("staging")?"staging":"prod",c=()=>`${l()}_quivers`,d=async e=>localStorage.getItem(e),u=async(e,t)=>{localStorage.setItem(e,t)},h=async e=>{localStorage.removeItem(e)},y=()=>{const[e,t]=(0,n.useState)([]),[r,y]=(0,n.useState)(!0),[p,m]=(0,n.useState)(null),g=async()=>{try{y(!0),m(null);const{data:{session:e}}=await o.N.auth.getSession();if(e?.user){const{data:r,error:n}=await o.N.from(c()).select("*").eq("environment",l()).eq("user_id",e.user.id).order("updated_at",{ascending:!1});if(n)throw n;t(r||[])}else{const e=await d(a);t(e?JSON.parse(e):[])}}catch(e){m(e instanceof Error?e.message:"Failed to load quivers"),t([])}finally{y(!1)}};return(0,n.useEffect)((()=>{g();const{data:{subscription:e}}=o.N.auth.onAuthStateChange((async e=>{"SIGNED_IN"===e&&await(async()=>{try{const{data:{session:e}}=await o.N.auth.getSession();if(!e?.user)return;const t=await d(a);if(!t)return;const r=JSON.parse(t),n=l();for(const s of r){const t=s.foils.map((e=>(0,i.h)(e))),r={name:s.name,description:s.description||"",foil_ids:t,is_public:s.is_public||!1,user_id:e.user.id,environment:n};await o.N.from(c()).insert([r])}await h(a),await g()}catch(e){}})(),await g()}));return()=>{e.unsubscribe()}}),[]),{quivers:e,isLoading:r,error:p,createQuiver:async r=>{try{m(null);const{data:{session:n}}=await o.N.auth.getSession();if(n?.user){const e=c(),a=l(),d=r.foils.map((e=>(0,i.h)(e))),u={name:r.name,description:r.description||"",user_id:n.user.id,environment:a,foil_ids:d,is_public:r.is_public||!1},{error:h}=await o.N.from(e).insert(u);if(h)throw s.v.error("Insert error:",{message:h.message,details:h.details,hint:h.hint,code:h.code}),h;const{data:y,error:p}=await o.N.from(e).select("*").eq("user_id",n.user.id).eq("name",r.name).order("created_at",{ascending:!1}).limit(1).single();if(p)throw p;if(!y)throw new Error("Failed to retrieve created quiver");const m=Object.assign({},y,{foils:r.foils});return t((e=>[m,...e])),m}{const n=l(),o=r.foils.map((e=>(0,i.h)(e))),s={id:(0,i.l)(),name:r.name,description:r.description||"",foil_ids:o,is_public:r.is_public||!1,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),user_id:"local",environment:n},c=[s,...e];return await u(a,JSON.stringify(c)),t(c),s}}catch(n){throw n}},updateQuiver:async(e,r)=>{m(null);try{const{data:{session:n}}=await o.N.auth.getSession();if(n?.user){const{error:t}=await o.N.from(c()).update(r).eq("id",e);if(t)throw t;return await g(),!0}{const n=await d(a);if(!n)return!1;const o=JSON.parse(n).map((t=>t.id===e?Object.assign({},t,r,{updated_at:(new Date).toISOString()}):t));return await u(a,JSON.stringify(o)),t(o),!0}}catch(p){return m("Failed to update quiver"),!1}},deleteQuiver:async r=>{try{m(null);const{data:{session:n}}=await o.N.auth.getSession();if(n?.user){const{error:e}=await o.N.from(c()).delete().eq("id",r).eq("user_id",n.user.id).eq("environment",l());if(e)throw e}const i=e.filter((e=>e.id!==r));return t(i),n?.user||await u(a,JSON.stringify(i)),!0}catch(n){return m(n instanceof Error?n.message:"Failed to delete quiver"),!1}},reloadQuivers:g}}},4667:(e,t,r)=>{r.d(t,{D:()=>u,N:()=>d});var n=r(6665),o=r(1243),i=r(1087),s=r(5713),a=r(397);const l=(0,n.createContext)(void 0),c="@foilquiver/theme",d=({children:e})=>{const t=(0,o.A)(),[r,d]=(0,n.useState)("dark"===t);(0,n.useEffect)((()=>{(async()=>{try{const e=await i.A.getItem(c);null!==e&&d("dark"===e)}catch(e){}})()}),[]);const u=(0,s.j)(r?"dark":"light");return(0,a.jsx)(l.Provider,{value:{isDark:r,colors:u,toggleTheme:async()=>{try{const e=!r;d(e),await i.A.setItem(c,e?"dark":"light")}catch(e){}}},children:e})},u=()=>{const e=(0,n.useContext)(l);if(void 0===e)throw new Error("useTheme must be used within a ThemeProvider");return e}},5713:(e,t,r)=>{r.d(t,{T:()=>h,j:()=>u});const n="#BF3475",o="#FFCE61",i="#F9FAFB",s="#E5E7EB",a="#374151",l="#111827",c={background:{primary:i,secondary:"#F3F4F6",tertiary:s},text:{primary:l,secondary:a,tertiary:"#6B7280",inverse:i},border:s,primary:n,error:"#DC2626",success:"#059669",warning:o},d={background:{primary:l,secondary:"#1F2937",tertiary:a},text:{primary:i,secondary:s,tertiary:"#9CA3AF",inverse:l},border:a,primary:n,error:"#EF4444",success:"#10B981",warning:o},u=e=>"dark"===e?d:c,h=c},2348:(e,t,r)=>{r.d(t,{Y:()=>n});const n={XSMALL:4,SMALL:8,MEDIUM:12,LARGE:16,XLARGE:24,XXLARGE:32,CONTAINER_PADDING:24,BUTTON_PADDING_H:16,BUTTON_PADDING_V:8,BUTTON_GAP:12,CONTROLS_BOTTOM:24,SCREEN_PADDING:24,TABLE_CONTAINER_PADDING:24,HEADER_PADDING:12,CONTENT_PADDING:16,CONTROLS_CONTAINER_BOTTOM:24,CONTROLS_CONTAINER_PADDING:24}},5025:(e,t,r)=>{r.d(t,{R2:()=>s,k4:()=>i,oe:()=>o});const n=e=>{window.plausible&&window.plausible(e.name,e.props?{props:e.props}:void 0)},o=(e,t)=>{n({name:"pageview",props:Object.assign({page:e},t)})},i=(e,t)=>{n({name:e,props:t})},s={VIEW_COMPARISON:"view_comparison",VIEW_QUIVER:"view_quiver",COMPARE_FOILS:"compare_foils",SAVE_QUIVER:"save_quiver",DELETE_QUIVER:"delete_quiver",UPDATE_QUIVER:"update_quiver",FILTER_FOILS:"filter_foils",SORT_FOILS:"sort_foils",SEARCH_FOILS:"search_foils"}},382:(e,t,r)=>{r.d(t,{h:()=>n,l:()=>o});const n=e=>`${e.brand.toLowerCase()}-${e.model.toLowerCase().replace(/\s+/g,"-")}`,o=()=>"undefined"!==typeof crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},5501:(e,t,r)=>{r.d(t,{v:()=>o});class n{isDevelopment=!1;constructor(){this.isDevelopment}static getInstance(){return n.instance||(n.instance=new n),n.instance}log(e,t,...r){if(this.isDevelopment||"error"===e){(new Date).toISOString(),e.toUpperCase();e}}debug(e,...t){this.log("debug",e,...t)}info(e,...t){this.log("info",e,...t)}warn(e,...t){this.log("warn",e,...t)}error(e,...t){this.log("error",e,...t)}}const o=n.getInstance()},9659:(e,t,r)=>{r.d(t,{JZ:()=>n});const n={browse:"/",comparison:"/comparison",quiver:"/quiver/:quiverId",terms:"/terms",privacy:"/privacy",contact:"/contact"}},3600:(e,t,r)=>{r.d(t,{E7:()=>c,Ir:()=>a,QZ:()=>u,pC:()=>d,pF:()=>l,ri:()=>s});var n=r(1087),o=r(5501);const i={FILTERS:"@foilquiver/filters",COLUMNS:"@foilquiver/columns",THEME:"@foilquiver/theme",SORT:"@foilquiver/sort"};new class{async set(e,t){try{const r=JSON.stringify(t);await n.A.setItem(e,r)}catch(r){throw o.v.error("Error setting storage item:",r),r}}async get(e){try{const t=await n.A.getItem(e);return null!=t?JSON.parse(t):null}catch(t){throw o.v.error("Error getting storage item:",t),t}}async remove(e){try{await n.A.removeItem(e)}catch(t){throw o.v.error("Error removing storage item:",t),t}}async clear(){try{await n.A.clear()}catch(e){throw o.v.error("Error clearing storage:",e),e}}async getAllKeys(){try{return await n.A.getAllKeys()}catch(e){throw o.v.error("Error getting all storage keys:",e),e}}};const s=async e=>{try{await n.A.setItem(i.FILTERS,JSON.stringify(e))}catch(t){}},a=async()=>{try{const e=await n.A.getItem(i.FILTERS);return e?JSON.parse(e):null}catch(e){return null}},l=async e=>{try{await n.A.setItem(i.COLUMNS,JSON.stringify(e))}catch(t){}},c=async()=>{try{const e=await n.A.getItem(i.COLUMNS);return e?JSON.parse(e):null}catch(e){return null}},d=async e=>{try{await n.A.setItem(i.SORT,JSON.stringify(e))}catch(t){}},u=async()=>{try{const e=await n.A.getItem(i.SORT);return e?JSON.parse(e):null}catch(e){return null}}},5701:(e,t,r)=>{r.d(t,{N:()=>n});const n=(0,r(8418).UU)("https://zhylhvuhhoialsgqrxxr.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpoeWxodnVoaG9pYWxzZ3FyeHhyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzkxNjM3NTgsImV4cCI6MjA1NDczOTc1OH0.wrZ05wA3EcbBubG3Mrxmx--fA9ThE2_M9k9WYTmGpag",{auth:{detectSessionInUrl:!0,flowType:"pkce",autoRefreshToken:!0,persistSession:!0}})}},e=>{e.O(0,[652],(()=>{return t=640,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=main.944d7dcd.js.map